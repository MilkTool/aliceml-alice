(*
 * Authors:
 *   Andreas Rossberg <rossberg@ps.uni-sb.de>
 *   Leif Kornstaedt <kornstae@ps.uni-sb.de>
 *
 * Copyright:
 *   Andreas Rossberg and Leif Kornstaedt, 1999-2002
 *
 * Last change:
 *   $Date$ by $Author$
 *   $Revision$
 *)

import structure __pervasive
       structure Int and LargeWord and Word from "Pervasive"
import type int and bool                    from "ToplevelTypes"
import structure MkWord                     from "MkWord"

structure Word31 = MkWord(
    type word = LargeWord.word

    val wordSize = 31

    __primitive val fromInt : Int.int  -> word = "Word31.fromInt"
    __primitive val toInt :   word -> Int.int  = "Word31.toInt"
    __primitive val toIntX :  word -> Int.int  = "Word31.toIntX"

    __primitive val fromLargeWord : LargeWord.word -> word = "Word31.fromLargeWord"
    __primitive val toLargeWord :   word -> LargeWord.word = "Word31.toLargeWord"
    __primitive val toLargeWordX :  word -> LargeWord.word = "Word31.toLargeWordX"

    __primitive val op + :   word * word -> word = "Word31.+"
    __primitive val op - :   word * word -> word = "Word31.-"
    __primitive val op * :   word * word -> word = "Word31.*"
    __primitive val op div : word * word -> word = "Word31.div"
    __primitive val op mod : word * word -> word = "Word31.mod"

    __primitive val notb :   word -> word        = "Word31.notb"
    __primitive val orb :    word * word -> word = "Word31.orb"
    __primitive val xorb :   word * word -> word = "Word31.xorb"
    __primitive val andb :   word * word -> word = "Word31.andb"

    __primitive val op << :  word * Word.word -> word = "Word31.<<"
    __primitive val op >> :  word * Word.word -> word = "Word31.>>"
    __primitive val op ~>> : word * Word.word -> word = "Word31.~>>"

    __primitive val op < :   word * word -> bool = "Word31.<"
    __primitive val op > :   word * word -> bool = "Word31.>"
    __primitive val op <= :  word * word -> bool = "Word31.<="
    __primitive val op >= :  word * word -> bool = "Word31.>="
)
